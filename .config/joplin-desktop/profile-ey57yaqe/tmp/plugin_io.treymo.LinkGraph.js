!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=joplin},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentScriptType=t.SettingStorage=t.AppType=t.SettingItemType=t.ToolbarButtonLocation=t.isContextMenuItemLocation=t.MenuItemLocation=t.ImportModuleOutputFormat=t.FileSystemItem=void 0,function(e){e.File="file",e.Directory="directory"}(t.FileSystemItem||(t.FileSystemItem={})),function(e){e.Markdown="md",e.Html="html"}(t.ImportModuleOutputFormat||(t.ImportModuleOutputFormat={})),function(e){e.File="file",e.Edit="edit",e.View="view",e.Note="note",e.Tools="tools",e.Help="help",e.Context="context",e.NoteListContextMenu="noteListContextMenu",e.EditorContextMenu="editorContextMenu",e.FolderContextMenu="folderContextMenu",e.TagContextMenu="tagContextMenu"}(o=t.MenuItemLocation||(t.MenuItemLocation={})),t.isContextMenuItemLocation=function(e){return[o.Context,o.NoteListContextMenu,o.EditorContextMenu,o.FolderContextMenu,o.TagContextMenu].includes(e)},function(e){e.NoteToolbar="noteToolbar",e.EditorToolbar="editorToolbar"}(t.ToolbarButtonLocation||(t.ToolbarButtonLocation={})),function(e){e[e.Int=1]="Int",e[e.String=2]="String",e[e.Bool=3]="Bool",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Button=6]="Button"}(t.SettingItemType||(t.SettingItemType={})),function(e){e.Desktop="desktop",e.Mobile="mobile",e.Cli="cli"}(t.AppType||(t.AppType={})),function(e){e[e.Database=1]="Database",e[e.File=2]="File"}(t.SettingStorage||(t.SettingStorage={})),function(e){e.MarkdownItPlugin="markdownItPlugin",e.CodeMirrorPlugin="codeMirrorPlugin"}(t.ContentScriptType||(t.ContentScriptType={}))},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function l(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),r=n(3),a=n(4),l=n(1);var s=n(5);let u,d,c=[];function f(){return o(this,void 0,void 0,(function*(){const e=yield i.default.settings.value("SETTING_MAX_SEPARATION_DEGREE"),t=yield i.default.settings.value("SETTING_MAX_NODES"),n=(yield i.default.settings.value("SETTING_NOTEBOOK_NAMES_TO_FILTER")).split(","),o=yield i.default.settings.value("SETTING_FILTER_CHILD_NOTEBOOKS"),a="include"===(yield i.default.settings.value("SETTING_FILTER_IS_INCLUDE_FILTER")),l=yield i.default.settings.value("SETTING_INCLUDE_BACKLINKS"),s=yield i.default.settings.value("SETTING_SHOW_LINK_DIRECTION"),u=yield i.default.workspace.selectedNote(),d=yield r.getNotes(u.id,t,e,n,o,a,l),c={nodes:[],edges:[],currentNoteID:u.id,nodeFontSize:yield i.default.settings.value("SETTING_NODE_FONT_SIZE"),nodeDistanceRatio:(yield i.default.settings.value("SETTING_NODE_DISTANCE"))/100,showLinkDirection:s,graphIsSelectionBased:e>0};return d.forEach((function(e,t){for(let o of e.links){var n=o.indexOf("#");-1!=n&&(o=o.substr(0,n));if(d.has(o))if(c.edges.push({source:t,target:o,sourceDistanceToCurrentNode:d.get(t).distanceToCurrentNote,targetDistanceToCurrentNode:d.get(o).distanceToCurrentNote,focused:t===u.id||o===u.id}),t===u.id)d.get(o).linkedToCurrentNote=!0;else if(o==u.id)d.get(t).linkedToCurrentNote=!0;else{const e=d.get(o);e.linkedToCurrentNote=e.linkedToCurrentNote||!1}}c.nodes.push({id:t,title:e.title,focused:e.linkedToCurrentNote,distanceToCurrentNode:e.distanceToCurrentNote})})),c}))}function p(){return o(this,void 0,void 0,(function*(){if(d&&c.length>0){let e=c.shift();d(e),d=void 0}}))}i.default.plugins.register({onStart:function(){return o(this,void 0,void 0,(function*(){yield a.registerSettings();const e=i.default.views.panels,t=yield e.create("note-graph-view");yield e.setHtml(t,"Note Graph is Loading");var n,h={},g=!1;function v(e){return o(this,void 0,void 0,(function*(){if(g)return;const t=yield i.default.settings.value("SETTING_MAX_SEPARATION_DEGREE");var a=!1;if(void 0===u)u=yield f(),a=!0;else if("noteChange"===e){const e=yield i.default.workspace.selectedNote();var l=r.getAllLinksForNote(e.body);s(l,n)||(n=l,a=!0)}else if("noteSelectionChange"===e&&0==t){const e=yield i.default.workspace.selectedNote();u.currentNoteID=e.id,u.edges.forEach(t=>{const n=t.source===e.id||t.target===e.id;t.focused=n}),u.nodes.forEach(t=>{t.focused=t.id===e.id}),a=!0}else u=yield f(),a=!s(u,h);a&&(h=u,function(e){o(this,void 0,void 0,(function*(){c.push(e)}))}({name:e,data:u}),p())}))}yield i.default.commands.register({name:"showHideGraphUI",label:"Show/Hide Graph View",iconName:"fas fa-sitemap",execute:()=>o(this,void 0,void 0,(function*(){const n=yield e.visible(t);e.show(t,!n)}))}),yield i.default.views.toolbarButtons.create("graphUIButton","showHideGraphUI",l.ToolbarButtonLocation.NoteToolbar),yield function(){return o(this,void 0,void 0,(function*(){yield e.setHtml(t,'\n                  <div class="graph-content">\n                      <div class="header-area">\n                        <button id="redrawButton">Redraw Graph</button>\n                        <p class="header">Note Graph</p>\n                      </div>\n                      <div class="container">\n                        <div id="user-input-container"></div>\n                        <div id="note_graph"/>\n                      </div>\n        </div>\n      ')}))}(),yield i.default.views.menuItems.create("showOrHideGraphMenuItem","showHideGraphUI",l.MenuItemLocation.View,{accelerator:"F8"}),yield e.addScript(t,"./webview.css"),yield e.addScript(t,"./ui/index.js"),e.onMessage(t,e=>{switch(e.name){case"poll":let t=new Promise(e=>{d=e});return p(),t;case"update":return{name:"update",data:u};case"navigateTo":i.default.commands.execute("openNote",e.id);break;case"get_note_tags":return r.getNoteTags(e.id);case"set_setting":return i.default.settings.setValue(e.key,e.value);case"get_setting":return i.default.settings.value(e.key)}}),yield i.default.workspace.onNoteChange(()=>o(this,void 0,void 0,(function*(){v("noteChange")}))),yield i.default.workspace.onNoteSelectionChange(()=>o(this,void 0,void 0,(function*(){v("noteSelectionChange")}))),yield i.default.workspace.onSyncStart(()=>o(this,void 0,void 0,(function*(){g=!0}))),yield i.default.workspace.onSyncComplete(()=>o(this,void 0,void 0,(function*(){g=!1,v("syncComplete")}))),yield i.default.settings.onChange(()=>o(this,void 0,void 0,(function*(){v("settingsChange")})))}))}})},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function l(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteTags=t.getAllLinksForNote=t.filterNotesByNotebookName=t.getNotes=void 0;const i=n(0);function r(e,t,n,i,r){return o(this,void 0,void 0,(function*(){if(n.length<1)return e;const o=new Map;t.forEach(e=>o.set(e.title,e.id));const a=new Map;t.forEach(e=>a.set(e.id,e)),n=n.filter(e=>o.has(e));var l=new Map;return e.forEach((function(e,t){(function(e){var t=a.get(e);if(n.includes(t.title))return r;if(i)for(;void 0!==t;){if(n.includes(t.title))return r;t=a.get(t.parent_id)}return!r})(e.parent_id)&&l.set(t,e)})),l}))}function a(e){const t=s(e.body);return e.body=null,{id:e.id,title:e.title,parent_id:e.parent_id,links:t}}function l(e){return o(this,void 0,void 0,(function*(){var t=e.map(e=>i.default.data.get(["notes",e],{fields:["id","parent_id","title","body"]}));return(yield Promise.all(t.map(e=>e.catch(e=>e)))).filter(e=>!(e instanceof Error))}))}function s(e){const t=new Set,n=/\[\]|\[.*?\]\(:\/(.*?)\)/g;var o=null;do{null!=(o=n.exec(e))&&void 0!==o[1]&&t.add(o[1])}while(null!=o);return t}function u(e){return o(this,void 0,void 0,(function*(){const t=[];let n,o=1;do{n=yield i.default.data.get(["search"],{query:e,fields:["id"],page:o++}),t.push(...n.items.map(({id:e})=>e))}while(n.has_more);return t}))}t.getNotes=function(e,t,n,s,d,c,f){return o(this,void 0,void 0,(function*(){var p=new Map;if(p=n>0?yield function(e,t,n){return o(this,void 0,void 0,(function*(){var o=[],i=new Set;const r=new Map;var s=0;o.push(e);do{const e=yield l(o);o.forEach(e=>i.add(e)),o=[];for(const t of e){const e=a(t);e.distanceToCurrentNote=s,r.set(t.id,e);[...e.links,...n?yield u(e.id):[]].forEach(e=>{i.has(e)||o.push(e)})}s++}while(o.length>0&&s<=t);return r}))}(e,n,f):yield function(e){return o(this,void 0,void 0,(function*(){var t=new Array,n=1;do{var o=yield i.default.data.get(["notes"],{fields:["id","parent_id","title","body"],order_by:"updated_time",order_dir:"DESC",limit:e<100?e:100,page:n});t.push(...o.items),n++}while(o.has_more&&t.length<e);const r=new Map;return t.map(e=>r.set(e.id,a(e))),r}))}(t),s.length>0){const e=yield function(){return o(this,void 0,void 0,(function*(){var e=[],t=1;do{var n=yield i.default.data.get(["folders"],{fields:["id","title","parent_id"],page:t});e.push(...n.items),t++}while(n.has_more);return e}))}();p=yield r(p,e,s,d,c)}return p}))},t.filterNotesByNotebookName=r,t.getAllLinksForNote=s,t.getNoteTags=function(e){return o(this,void 0,void 0,(function*(){const t=[];let n,o=1;do{n=yield i.default.data.get(["notes",e,"tags"],{fields:["id","title"],page:o++}),t.push(...n.items)}while(n.has_more);return t}))}},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function l(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.registerSettings=void 0;const i=n(0),r=n(1);t.registerSettings=function(){return o(this,void 0,void 0,(function*(){const e="graph-ui.settings";yield i.default.settings.registerSection(e,{label:"Graph UI",iconName:"fas fa-sitemap"}),yield i.default.settings.registerSettings({SETTING_NODE_FONT_SIZE:{value:20,type:r.SettingItemType.Int,section:e,public:!0,label:"Size of the node label font",description:"Font size for the label of nodes on the graph.."},SETTING_NODE_DISTANCE:{value:100,type:r.SettingItemType.Int,section:e,public:!0,label:"Distance between nodes",description:"The visual distance between nodes in the graph."},SETTING_MAX_NODES:{value:700,type:r.SettingItemType.Int,section:e,public:!0,label:"Max nodes in graph",description:"Maximum number of nodes shown in the graph. Most recent nodes have priority."},SETTING_FILTER_IS_INCLUDE_FILTER:{value:"exclude",type:r.SettingItemType.String,isEnum:!0,section:e,public:!0,options:{include:"Include",exclude:"Exclude"},label:"Should notes in the filtered notebooks be included or excluded?",description:"Include will show only notebooks in the filter list and exclude will show all notebooks not in the filter list."},SETTING_NOTEBOOK_NAMES_TO_FILTER:{value:"",type:r.SettingItemType.String,section:e,public:!0,label:"Notebooks names to filter",description:"Comma separated list of Notebook names to filter."},SETTING_FILTER_CHILD_NOTEBOOKS:{value:!0,type:r.SettingItemType.Bool,section:e,public:!0,label:"Filter child notebooks",description:"Filters notebooks that are children of the notebooks listed above."},SETTING_MAX_SEPARATION_DEGREE:{value:0,type:r.SettingItemType.Int,minimum:0,section:e,public:!1,label:"Max degree of separation",description:"Maximum number of link jumps from selected note. Zero for all notes"},SETTING_INCLUDE_BACKLINKS:{value:!1,type:r.SettingItemType.Bool,section:e,public:!0,label:"Include note back-links for selected note",description:"Backlinks are links that other notes have to the selected note. Note: This setting is targeted towards selection-based graphs with degree of separation > 0."},SETTING_SHOW_LINK_DIRECTION:{value:!1,type:r.SettingItemType.Bool,section:e,public:!0,label:"Show note link direction arrows",description:"With more complex graphs, arrows showing the link direction from note to note can be quite helpful."}})}))}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var o,i,r;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(i=o;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=o;0!=i--;){var a=r[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n}}]);