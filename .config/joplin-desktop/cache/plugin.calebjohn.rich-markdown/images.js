exports.default=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function r(e,t,n){const r=e.indexOf("tick")>0;return{name:"RichMarkdownOverlay-"+e,requiredSettings:n,token:function(n){const i=function(e,t){return e.lastIndex=t.pos,e.exec(t.string)}(t,n),o=n.baseToken();if((null==o?void 0:o.type)&&(!r&&(o.type.includes("jn-inline-code")||o.type.includes("comment"))||o.type.includes("katex")))n.pos+=o.size;else{if(i&&i.index===n.pos)return n.pos+=i[0].length||1,e;i?n.pos=i.index:n.skipToEnd()}return null}}}Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.add=t.table_regex=t.blockquote_regex=t.hr_regex=t.list_token_regex=t.header_regex=t.admonition_line_regex=t.admonition_token_regex=t.backtick_block_token_regex=t.backtick_token_regex=t.strike_token_regex=t.sup_token_regex=t.sub_token_regex=t.insert_token_regex=t.highlight_token_regex=t.strong_underline_regex=t.strong_star_regex=t.emph_underline_regex=t.emph_star_regex=t.sup_regex=t.sub_regex=t.insert_regex=t.highlight_regex=t.html_image_regex=t.image_regex=t.link_regex=t.checkbox_inner_regex=t.checkbox_regex=void 0,t.checkbox_regex=/^(\s*)([*+-] )(\[[Xx ]\])\s.*$/g,t.checkbox_inner_regex=/(?<=\[)[Xx ](?=\])/g,t.link_regex=/(?<![\\])\[[^\]]*\]\(([^\(\)]+)\)|<([^>\s]+\.[^>\s]+)>|((?:[a-zA-Z0-9\+\.\-])+:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|(?:[a-zA-Z0-9\+\.\-])+:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,}[^\)])(?<!\))|joplin:\/\/x-callback-url\/.*/g,t.image_regex=/!\[[^\]]*\]\([^\(]+\)/g,t.html_image_regex=/<img([^>]+?)\/?>/g,t.highlight_regex=/(?<!\\)==(?=[^\s])[^=]*[^=\s\\]==/g,t.insert_regex=/(?<!\\)\+\+(?=[^\s])[^\+]*[^\+\s\\]\+\+/g,t.sub_regex=/(?<![\\~])~(?=[^\s])[^~]*[^~\s\\]~/g,t.sup_regex=/(?<![\\[])\^(?=[^\s])[^\^]*[^\^\s\\[]\^/g,t.emph_star_regex=/(?<![\\\*])\*(?!\*)/g,t.emph_underline_regex=/(?<![\\\_])\_(?!\_)/g,t.strong_star_regex=/(?<![\\\*])\*\*(?!\*)/g,t.strong_underline_regex=/(?<![\\\_])\_\_(?!\_)/g,t.highlight_token_regex=/(?<![\\=])==(?!=)/g,t.insert_token_regex=/(?<![\\\+])\+\+(?!\+)/g,t.sub_token_regex=/(?<![\\~])~(?!~)/g,t.sup_token_regex=/(?<![\\\^])\^(?!\^)/g,t.strike_token_regex=/(?<![\\~])~~(?!~~)/g,t.backtick_token_regex=/(?<![\\`])`(?!`)/g,t.backtick_block_token_regex=/^```\S*$/g,t.admonition_token_regex=/^!!!/g,t.admonition_line_regex=/^!!!.*$/g,t.header_regex=/^\s*#+\s/g,t.list_token_regex=/^(\s*)([*+-] \[[Xx ]\]\s|[*+->]\s|(\d+)([.)]\s))(\s*)/g,t.hr_regex=/^([*\-_])(?:\s*\1){2,}\s*$/,t.blockquote_regex=/^\s*\>+\s/g,t.table_regex=/^\|[^\n]+\|/g;const i=[r("rm-checkbox",t.checkbox_regex,[]),r("rm-checkbox-check",t.checkbox_inner_regex,["extraCSS"]),r("rm-link",t.link_regex,[]),r("rm-image",t.image_regex,[]),r("rm-image",t.html_image_regex,[]),r("rm-list-token",t.list_token_regex,[]),r("rm-ins",t.insert_regex,["insertHighlight"]),r("rm-sub",t.sub_regex,["subHighlight"]),r("rm-sup",t.sup_regex,["supHighlight"]),r("rm-header-token",t.header_regex,["extraCSS"]),r("line-cm-rm-blockquote",t.blockquote_regex,["extraCSS"]),r("rm-em-token",t.emph_star_regex,["extraCSS"]),r("rm-em-token",t.emph_underline_regex,["extraCSS"]),r("rm-strong-token",t.strong_star_regex,["extraCSS"]),r("rm-strong-token",t.strong_underline_regex,["extraCSS"]),r("rm-highlight",t.highlight_regex,["markHighlight"]),r("rm-highlight-token",t.highlight_token_regex,["extraCSS","markHighlight"]),r("rm-ins-token",t.insert_token_regex,["extraCSS","insertHighlight"]),r("rm-sub-token",t.sub_token_regex,["extraCSS","subHighlight"]),r("rm-sup-token",t.sup_token_regex,["extraCSS","supHighlight"]),r("rm-strike-token",t.strike_token_regex,["extraCSS"]),r("rm-backtick-token",t.backtick_token_regex,["extraCSS"]),r("rm-triptick-token",t.backtick_block_token_regex,["extraCSS"]),r("rm-hr line-cm-rm-hr",t.hr_regex,["extraCSS"]),r("rm-admonition-token line-cm-rm-admonition line-background-cm-rm-admonition",t.admonition_token_regex,["extraCSS"]),r("rm-admonition",t.admonition_line_regex,["extraCSS"])];function o(e,t){for(let n of t)if(!e[n]&&("extraCSS"!==n||"none"===e.theme&&!e.extraFancy))return!1;return!0}t.add=function(e){if(e.state.richMarkdown)for(let t of i)o(e.state.richMarkdown.settings,t.requiredSettings)&&e.addOverlay(t)},t.remove=function(e){for(let t of i)e.removeOverlay(t)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllWidgets=t.refreshResource=t.afterSourceChanges=t.onSourceChanged=t.html_image_line_regex=t.image_inline_regex=t.image_line_link_regex=t.image_line_regex=void 0;const i=n(2),o=n(0);t.image_line_regex=/^\s*!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)({width=(\d+(px|%)?)})?\s*$/,t.image_line_link_regex=/^\[(!\[.*)\]\((.*)\)$/,t.image_inline_regex=/!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)({width=(\d+(px|%)?)})?/g,t.html_image_line_regex=/^\s*<img([^>]+?)\/?>\s*$/;let s={};function l(e){return function(n){return r(this,void 0,void 0,(function*(){if(!n.target)return;if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.settings.imageHover)return;if(!e.state.richMarkdown.settings.imageHoverCtrl&&(!n.ctrlKey&&!n.altKey||e.state.richMarkdown.isMouseHovering))return;e.state.richMarkdown.isMouseHovering=!0;const s=n.target;if(!s.offsetParent)return;if(e.state.richMarkdown.settings.inlineImages&&s.parentNode.childNodes.length<=3)return;const l=yield function(e,n){return r(this,void 0,void 0,(function*(){let{line:r,ch:s}=n;const l=e.getLine(r),c=i.getMatchAt(l,t.image_inline_regex,s);let a=null;if(c)a=yield u(c[2],c[1],e.state.richMarkdown.path_from_id,c[4],c[5]);else{const t=i.getMatchAt(l,o.html_image_regex,s);t&&(a=yield g(t[0],e.state.richMarkdown.path_from_id))}return a}))}(e,i.getClickCoord(e,n));if(l){if(l.style.zoom){let e=parseFloat(l.style.zoom);l.style.zoom.endsWith("%")&&(e/=100),e&&(l.width*=e,l.height*=e,l.style.zoom="100%")}l.style.visibility="hidden",s.offsetParent.appendChild(l),l.style.position="absolute",l.style.zIndex="1000",l.classList.add("rich-markdown-hover-image"),l.onload=function(){if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.isMouseHovering)return void l.remove();let t=this;const r=s.offsetParent,{right:i,width:o}=r.getBoundingClientRect();let c=0;t.clientWidth<o&&(c=Math.min(n.clientX,i-t.clientWidth));const a=e.coordsChar({left:c,top:n.clientY},"page");t.style.visibility="visible",e.addWidget(a,l,!1)}}}))}}function c(e){const t=e.getWrapperElement().getElementsByClassName("rich-markdown-hover-image");for(let e=t.length-1;e>=0;e--)t[e].remove()}function a(e){return function(t){e.state.richMarkdown&&(e.state.richMarkdown.isMouseHovering=!1),c(e)}}function g(e,t){return r(this,void 0,void 0,(function*(){const n=(new DOMParser).parseFromString(e,"text/html").body.firstChild;n.style.height=n.style.height||"auto",n.style.maxWidth=n.style.maxWidth||"100%";const r=["script","noscript","iframe","frameset","frame","object","base","embed","link","meta"];for(let e=0;e<n.attributes.length;e++){const t=n.attributes[e].name;(r.includes(t)||t.startsWith("on"))&&(n.attributes[e].value="")}if(n.src.length>=34){const e=n.src.substring(n.src.length-34);e.startsWith(":/")&&(n.src=yield t(e.substring(2)),n.id=e.substring(2))}return n}))}function u(e,t,n,i,o,s,l){return r(this,void 0,void 0,(function*(){let r=e.substring(2);e.startsWith(":/")&&34==e.length&&(e=yield n(r)),e.startsWith("<")&&e.endsWith(">")&&(e=e.substring(1,e.length-1));const c=document.createElement("img");return c.src=e,c.alt=t,c.style.maxWidth="100%",c.style.height="auto",l&&s&&(c.onclick=()=>{s.postMessage({name:"followLink",url:l})}),i&&(c.style.width=i+(o?"":"px")),c.id=r,c}))}t.onSourceChanged=function(e,n,i,o){e.state.richMarkdown&&e.state.richMarkdown.settings.inlineImages&&function(e,n,i,o){var l,c,a;r(this,void 0,void 0,(function*(){if(!e.state.richMarkdown)return;const r=e.state.richMarkdown.path_from_id;let h=!1;for(let d=n;d<=i;d++){const n=e.lineInfo(d);if(n.widgets)for(const e of n.widgets)"rich-markdown-resource"===e.className&&e.clear(),delete s[e.node.id];if(!n)continue;const i=e.getStateAfter(d,!0);if((null==i?void 0:i.outer)&&((null===(l=null==i?void 0:i.outer)||void 0===l?void 0:l.code)||(null===(a=null===(c=null==i?void 0:i.outer)||void 0===c?void 0:c.thisLine)||void 0===a?void 0:a.fencedCodeEnd)))continue;const _=n.text.match(t.image_line_link_regex);let x=n.text,m="";_&&(x=_[1],m=_[2]);const f=x.match(t.image_line_regex);let k=null;if(f)k=yield u(f[2],f[1],r,f[4],f[5],o,m);else{const e=n.text.match(t.html_image_line_regex);e&&(k=yield g(e[0],r))}if(k){const t=e.addLineWidget(d,k,{className:"rich-markdown-resource"});s[k.id]=t,h=!0}}h&&e.refresh()}))}(e,n,i,o)},t.afterSourceChanges=function(e){e.state.richMarkdown&&e.state.richMarkdown.settings.imageHover&&function(e){if(!e.state.richMarkdown)return;const t=e.getWrapperElement().getElementsByClassName("cm-rm-image");for(let n of t)n.onmouseenter=l(e),n.onmouseleave=a(e),e.state.richMarkdown.settings.imageHoverCtrl||(n.onmousemove=l(e))}(e)},t.refreshResource=function(e,t){const n=(new Date).getTime();let r=s[t];const i=r.node.src.split("?t=")[0],o=r.node.height;r.node.onload=function(){0!=this.getClientRects().length&&this.height!=o&&e.refresh()},r.node.src=`${i}?t=${n}`},t.clearAllWidgets=function(e){c(e);for(let e in s)s[e].clear();s={},e.refresh()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleCheckbox=t.getItemsAt=t.TextItemType=t.clickAt=t.getClickCoord=t.getMatchAt=t.isCheckbox=t.isLink=void 0;const r=n(0);function i(e,t,n){let r=null;if(t.lastIndex=0,!t.global)return console.error("getMatchAt requires a global regex; Consider adding a `g` after ${regex}"),null;do{if(r=t.exec(e),!r)break;const i=r.index,o=i+r[0].length;if(i<=n&&n<=o)return r}while(r);return null}var o;function s(e,t){let{line:n,ch:o}=t;const s=e.getLine(n),l=i(s,r.link_regex,o);if(!l)return;let c="";for(let e=1;e<=4;e++)c=c||l[e];return c&&c.endsWith(")")?i(s,r.image_regex,o)&&(c=c.slice(0,c.length-1)):c&&(c.endsWith('"')||c.endsWith("'"))&&(c=c.slice(0,c.length-1)),c=c.split(" ")[0],c}function l(e,t){const{line:n,ch:o}=t,s=e.getLine(n),l=i(s,r.checkbox_regex,o);return l&&l[3]?{match:l,lineText:s,line:n}:null}function c(e,t){const n=e.getCursor(),{match:r,line:i,lineText:o}=l(e,t);let s=o.indexOf(r[3]),c=s+r[3].length;const a=" "===r[3][1]?"[x]":"[ ]";return e.replaceRange(a,{ch:s,line:i},{ch:c,line:i},"+input"),e.setCursor(n,null,{scroll:!1}),!0}t.isLink=function(e){return!!e.target&&e.target.classList.contains("cm-rm-link")},t.isCheckbox=function(e){return!!e.target&&e.target.classList.contains("cm-rm-checkbox")},t.getMatchAt=i,t.getClickCoord=function(e,t){return(n=e.coordsChar({left:t.clientX,top:t.clientY})).sticky&&"before"===n.sticky?{ch:n.ch-1,line:n.line}:n;var n},t.clickAt=function(e,t){if(!e.state.richMarkdown)return;const n=e.state.richMarkdown.settings;if(n.links){const n=s(e,t);if(n)return{name:"followLink",url:n}}return n.checkbox&&c(e,t),null},function(e){e.Link="link",e.Checkbox="checkbox"}(o=t.TextItemType||(t.TextItemType={})),t.getItemsAt=function(e,t){if(!e.state.richMarkdown)return null;const n=e.state.richMarkdown.settings;let r=[];if(n.links){const n=s(e,t);n&&r.push({type:o.Link,url:n,coord:t})}if(n.checkbox){l(e,t)&&r.push({type:o.Checkbox,coord:t})}return r},t.toggleCheckbox=c}]).default;