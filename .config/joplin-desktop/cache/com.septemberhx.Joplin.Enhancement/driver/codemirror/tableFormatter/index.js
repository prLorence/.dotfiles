exports.default=function(e){var t={};function n(l){if(t[l])return t[l].exports;var i=t[l]={i:l,l:!1,exports:{}};return e[l].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(l,i,function(t){return e[t]}.bind(null,i));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var l=this&&this.__createBinding||(Object.create?function(e,t,n,l){void 0===l&&(l=n),Object.defineProperty(e,l,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,l){void 0===l&&(l=n),e[l]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&l(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isCurrSelectionInTable=t.navigateCell=t.insertColumn=t.insertRow=t.deleteColume=t.alignColumns=void 0;const r=o(n(2));function s(e){return e.trim().startsWith("|")}function c(e){const t=e.getDoc();let n=t.listSelections()[0].anchor.line;return s(t.getLine(n))}function a(e,t){let n=t.anchor.line,l=t.anchor.line;for(;n-1>=0;){if(!s(e.getLine(n))){n++;break}n--}for(;l+1<e.lineCount();){if(!s(e.getLine(l+1)))break;l++}const i={anchor:{line:n,ch:0},head:{line:l,ch:1e4}};e.setSelection(i.anchor,i.head);return[n,l,i,e.getSelection()]}t.alignColumns=function(e,t){const n=e.getDoc(),l=n.listSelections()[0];if(!n.getLine(l.anchor.line).trim().startsWith("|"))return;const i=a(n,l),o=i[0],s=(i[1],i[2]),c=i[3];let u=r.stringToTableData(c);if(void 0===u.aligns[0][0])return;const[f,h]=[l.anchor.line-o,l.anchor.ch],[d,g]=r.getCellAtPosition(u,f,h),[m,b]=[l.head.line-o,l.head.ch],[p,C]=r.getCellAtPosition(u,m,b);if(d===p)for(let e=g;e<=C;e++)u.aligns[e]=t;else if(d+1===p){for(let e=g;e<=u.columns.length;e++)u.aligns[e]=t;for(let e=0;e<=C;e++)u.aligns[e]=t}else for(let e=0;e<u.columns.length;e++)u.aligns[e]=t;const v=r.toFormatTableStr(u);n.replaceRange(v,s.anchor,s.head);const[w,y]=[l.anchor.line-o,l.anchor.ch],[T,_]=r.getCellAtPosition(u,w,y),P=r.toFormatTableStr(u),O=r.stringToTableData(P),[A,S]=r.getPositionOfCell(O,T,_),D={line:s.anchor.line+A,ch:s.anchor.ch+S+1};n.setSelection(D)},t.deleteColume=function(e){if(!c(e))return;const t=e.getDoc(),n=t.listSelections()[0],l=a(t,n),i=l[0],o=(l[1],l[2]),s=l[3],[u,f]=[n.head.line-i,n.head.ch],h=r.stringToTableData(s);if(1==h.columns.length)return;const[d,g]=r.getCellAtPosition(h,u,f),m=r.deleteColumn(h,g),b=r.toFormatTableStr(m),p=r.stringToTableData(b);t.replaceRange(b,o.anchor,o.head);let C=g;C>=p.columns.length&&(C=p.columns.length-1);const[v,w]=r.getPositionOfCell(p,d,C),y={line:o.anchor.line+v,ch:o.anchor.ch+w+1};t.setSelection(y)},t.insertRow=function(e,t){if(!c(e))return;const n=e.getDoc(),l=n.listSelections()[0],i=a(n,l),o=i[0],s=(i[1],i[2]),u=i[3],[f,h]=[l.head.line-o,l.head.ch],d=r.stringToTableData(u),[g,m]=r.getCellAtPosition(d,f,h),b=t?g-1:g,p=r.insertRow(d,b-1),C=r.toFormatTableStr(p),v=r.stringToTableData(C);n.replaceRange(C,s.anchor,s.head);const w=b+1,[y,T]=r.getPositionOfCell(v,w,m),_={line:s.anchor.line+y,ch:s.anchor.ch+T+1};n.setSelection(_)},t.insertColumn=function(e,t){if(!c(e))return;const n=e.getDoc(),l=n.listSelections()[0],i=a(n,l),o=i[0],s=(i[1],i[2]),u=i[3],[f,h]=[l.head.line-o,l.head.ch],d=r.stringToTableData(u),[g,m]=r.getCellAtPosition(d,f,h),b=t?m:m+1,p=r.insertColumn(d,b),C=r.toFormatTableStr(p),v=r.stringToTableData(C);n.replaceRange(C,s.anchor,s.head);const w=b,[y,T]=r.getPositionOfCell(v,g,w),_={line:s.anchor.line+y,ch:s.anchor.ch+T+1};n.setSelection(_)},t.navigateCell=function(e,t,n=!1){if(!c(e))return;const l=e.getDoc(),i=l.listSelections()[0],o=a(l,i),s=o[0],u=(o[1],o[2]),f=o[3],[h,d]=[i.head.line-s,i.head.ch];let g=r.stringToTableData(f);if(void 0===g.aligns[0][0])return;const[m,b]=r.getCellAtPosition(g,h,d);let p=!1;if(n){if(b<=0&&m<=0)return}else{p=b+1>=g.columns.length;!0===(m<=1&&0===g.cells.length||p&&m>=g.cells.length+1)&&(g=r.insertRow(g,g.cells.length))}const C=t?r.toFormatTableStr(g):g.originalText,v=r.stringToTableData(C);let w,y;l.replaceRange(C,u.anchor,u.head),n?(w=b>0?b-1:v.columns.length-1,y=b>0?m:m-1):(w=!0===p?0:b+1,y=!0===p?m+1:m);const[T,_]=r.getPositionOfCell(v,y,w),P={line:u.anchor.line+T,ch:u.anchor.ch+_+1};l.setSelection(P)},t.isCurrSelectionInTable=c},function(e,t,n){"use strict";var l=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(i,o){function r(e){try{c(l.next(e))}catch(e){o(e)}}function s(e){try{c(l.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((l=l.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=i(n(5));e.exports={default:function(e){return{plugin:function(e){function t(e,t){if("Tab"!==t.code||t.shiftKey){if("Tab"===t.code&&t.shiftKey)o.navigateCell(e,!0,!0);else if(t.shiftKey&&t.ctrlKey&&!t.metaKey)switch(t.code){case"ArrowLeft":o.insertColumn(e,!0);break;case"ArrowRight":o.insertColumn(e,!1);break;case"ArrowUp":o.insertRow(e,!0);break;case"ArrowDown":o.insertRow(e,!1);break;case"Backspace":o.deleteColume(e)}}else o.navigateCell(e,!0,!1)}e.defineOption("tableFormatter",[],(function(n,i,o){return l(this,void 0,void 0,(function*(){o&&o!=e.Init&&n.off("keyup",t),n.on("keyup",t);const l=new r.default(n);e.defineExtension("insertColumnLeft",l.insertColumnLeft.bind(l)),e.defineExtension("insertColumnRight",l.insertColumnRight.bind(l)),e.defineExtension("insertRowAbove",l.insertRowAbove.bind(l)),e.defineExtension("insertRowBelow",l.insertRowBelow.bind(l)),e.defineExtension("deleteColumn",l.deleteColumn.bind(l)),e.defineExtension("alignColumns",l.alignColumnsCommand.bind(l))}))}))},codeMirrorOptions:{tableFormatter:!0},assets:function(){return[]}}}}},function(e,t,n){"use strict";var l=this&&this.__createBinding||(Object.create?function(e,t,n,l){void 0===l&&(l=n),Object.defineProperty(e,l,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,l){void 0===l&&(l=n),e[l]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&l(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCellData=t.getCellAtPosition=t.getPositionOfCell=t.toFormatTableStr=t.insertColumn=t.deleteColumn=t.insertRow=t.tsvToTableData=t.stringToTableData=void 0;const s=r(n(3)),c=o(n(4));function a(e){let t=e.columns.length,n=new Array;for(let t=0;t<e.columns.length;t++){let l=c.getLen(e.columns[t].trim());n[t]=3>l?3:l}for(let l=0;l<e.cells.length;l++){let i=e.cells[l];for(let e=0;e<i.length&&!(e>t);e++){let t=c.getLen(i[e].trim());n[e]=n[e]>t?n[e]:t}}let l=new Array;for(let i=0;i<e.cells.length;i++){l[i]="",l[i]+=e.indent;let o=e.cells[i];for(let r=0;r<t;r++){let t="";r<o.length&&(t=o[r].trim());let s=c.getLen(t);l[i]+="| ";{let[o,c]=e.aligns[r];if(":"===o&&":"===c){for(let e=0;e<(n[r]-s)/2-.5;e++)l[i]+=" ";l[i]+=t;for(let e=0;e<(n[r]-s)/2;e++)l[i]+=" "}else if("-"===o&&":"===c){for(let e=0;e<n[r]-s;e++)l[i]+=" ";l[i]+=t}else{l[i]+=t;for(let e=0;e<n[r]-s;e++)l[i]+=" "}}l[i]+=" "}l[i]+="|",e.leftovers[i].length>0&&(l[i]+=e.leftovers[i])}let i="";i+=e.indent;for(let l=0;l<t;l++){const t=e.columns[l].trim(),o=c.getLen(t);i+="| ";{let[r,s]=e.aligns[l];if(":"===r&&":"===s){for(let e=0;e<(n[l]-o)/2-.5;e++)i+=" ";i+=t;for(let e=0;e<(n[l]-o)/2;e++)i+=" "}else if("-"===r&&":"===s){for(let e=0;e<n[l]-o;e++)i+=" ";i+=t}else{i+=t;for(let e=0;e<n[l]-o;e++)i+=" "}}i+=" "}i+="|";let o="";o+=e.indent;for(let l=0;l<t;l++){let[t,i]=e.aligns[l];o+="| "+t;for(let e=1;e<n[l]-1;e++)o+="-";o+=i+" "}return o+="|",l.splice(0,0,i),l.splice(1,0,o),l.join("\r\n")}t.stringToTableData=function(e){let t=e.split(/\r\n|\n|\r/),n=c.splitline(t[0],0),l=n.length,i=(e=>{if(e.trim().startsWith("|")){return e.split("|")[0]}return""})(t[0]),o=new Array,r=c.splitline(t[1],l,"---").map(e=>e.trim());for(let e=0;e<l;e++){let t=r[e];o[e]=[t[0],t.slice(-1)]}let a=new Array,u=new Array,f=-1;for(let e=2;e<t.length;e++){f++;let n=c.splitline(t[e],l);if(a[f]=n.slice(0,l),u[f]="",n.length>l){let e=n.slice(l,n.length);u[f]=e.join("|")}}return new s.default(e,o,n,a,u,i)},t.tsvToTableData=function(e){let t=e.split(/\r\n|\n|\r/),n=new Array,l=t[0].split("\t"),i=l.length;for(let e=0;e<i;e++)n[e]=l[e].trim();let o=new Array,r=new Array;for(let e=1;e<t.length;e++){o[e-1]=new Array;for(let t=0;t<i;t++)o[e-1][t]=" ";r[e-1]="";let n=t[e].split("\t");for(let t=0;t<n.length;t++)t>=i?r[e-1]+="\t"+n[t]:o[e-1][t]=n[t].trim()}let c=new Array;for(let e=0;e<i;e++)c[e]=[":","-"];const u=new s.default("",c,n,o,r,"");return new s.default(a(u),c,n,o,r,"")},t.insertRow=function(e,t){const n=e.columns,l=e.aligns,i=e.cells,o=e.leftovers,r=e.columns.length,c=e.indent;i.splice(t,0,Array.from({length:r},()=>"  ")),o.splice(t,0,"");const u=new s.default("",l,n,i,o,c);return new s.default(a(u),l,n,i,o,c)},t.deleteColumn=function(e,t){let n=e.columns,l=e.aligns,i=e.cells,o=e.leftovers,r=(e.columns.length,e.indent);n.splice(t,1),l.splice(t,1);for(let e=0;e<i.length;e++)i[e].splice(t,1);const c=new s.default("",l,n,i,o,r);return new s.default(a(c),l,n,i,o,r)},t.insertColumn=function(e,t){let n=e.columns,l=e.aligns,i=e.cells,o=e.leftovers,r=(e.columns.length,e.indent);n.splice(t,0,""),l.splice(t,0,["-","-"]);for(let e=0;e<i.length;e++)i[e].splice(t,0,"");const c=new s.default("",l,n,i,o,r);return new s.default(a(c),l,n,i,o,r)},t.toFormatTableStr=a,t.getPositionOfCell=function(e,t,n){let l=t<=0?0:t,i=e.originalText.split(/\r\n|\n|\r/)[t],o=c.splitline(i,e.columns.length),r=0;r+=e.indent.length,r+=1;for(let e=0;e<n;e++)r+=o[e].length,r+=1;return[l,r]},t.getCellAtPosition=function(e,t,n){let l=t<=0?0:t,i=e.originalText.split(/\r\n|\n|\r/)[l],o=c.splitline(i,e.columns.length),r=-1,s=e.indent.length;for(let e of o)if(r++,s+=1+e.length,n<=s)break;return[l,r]},t.getCellData=function(e,t,n){if(0===t)return e.columns.length>n?e.columns[n]:"";if(1===t){if(e.aligns.length<=n)return"---";let[t,l]=e.aligns[n];return" "+t+"-"+l+" "}return t>=e.cells.length+2?"":e.cells[t-2][n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,l,i,o){this.originalText=e,this.aligns=t,this.columns=n,this.cells=l,this.leftovers=i,this.indent=o}}},function(e,t,n){"use strict";function l(e){return 734===e||e>=768&&e<=879||e>=1155&&e<=1159||e>=1424&&e<=1487}function i(e){return e>=9344&&e<=9471||e>=9728&&e<=10239||e>=10496&&e<=11519||e>=11776&&e<=65376||e>=65440}function o(e){return e>=127744&&e<=130047}Object.defineProperty(t,"__esModule",{value:!0}),t.getLen=t.splitline=void 0,t.splitline=function(e,t,n=""){(e=e.trim()).startsWith("|")&&(e=e.slice(1)),e.endsWith("|")&&(e=e.slice(0,-1));let l=[],i=0,o=0,r=!1,s=!1;for(let t=0;t<e.length;++t){if(r){r=!1,o++;continue}const n=e.charAt(t);if("`"===n){s=!s,o++;continue}if(s){o++;continue}if("\\"===n){r=!0,o++;continue}if("|"!==n){o++;continue}let c=e.slice(i,o);l.push(c),i=t+1,o=t+1}l.push(e.slice(i));let c=new Array(t).fill(n);for(let e=0;e<l.length;e++)c[e]=l[e];return c},t.getLen=function(e){let t=0;for(let n=0;n<e.length;n++){let r=e.codePointAt(n);if(void 0===r)continue;let s=r;l(s)?t+=0:o(s)?t+=3:i(s)?t+=2:t+=1;let c=e.charCodeAt(n);c>=55296&&c<=56319&&n++}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const l=n(0);t.default=class{constructor(e){this.editor=e,this.doc=this.editor.getDoc()}insertColumnLeft(){l.insertColumn(this.editor,!0)}insertColumnRight(){l.insertColumn(this.editor,!1)}insertRowAbove(){l.insertRow(this.editor,!0)}insertRowBelow(){l.insertRow(this.editor,!1)}deleteColumn(){l.deleteColume(this.editor)}alignColumnsCommand(e){l.alignColumns(this.editor,e)}}}]).default;