!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=joplin},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{u(i.next(t))}catch(t){a(t)}}function l(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,l)}u((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=n(0),a=n(2),r=n(3);o.default.plugins.register({onStart:function(){return i(this,void 0,void 0,(function*(){console.info("Tagging plugin started"),yield o.default.commands.register({name:"CopyAllTags",label:"Copy all tags",enabledCondition:"noteListHasNotes",execute:()=>i(this,void 0,void 0,(function*(){return r.tagging.copyAllTags()}))}),yield o.default.views.menuItems.create("myMenuItemToolsCopyAllTags","CopyAllTags",a.MenuItemLocation.Tools),yield o.default.views.menuItems.create("contextMenuItemCopyAllTags","CopyAllTags",a.MenuItemLocation.NoteListContextMenu),yield r.tagging.createDialog(),yield o.default.commands.register({name:"TaggingDialog",label:"Tagging dialog",enabledCondition:"noteListHasNotes",execute:()=>i(this,void 0,void 0,(function*(){const t=yield o.default.workspace.selectedNoteIds();if(t.length>0){const e=yield r.tagging.getTaggingInfo(t),n=yield r.tagging.showTaggingDialog(e);"ok"==n.id&&(yield r.tagging.processTags(t,n.formData.tags,e))}}))}),yield o.default.views.menuItems.create("MenuItemToolsTaggingDialog","TaggingDialog",a.MenuItemLocation.Tools),yield o.default.views.menuItems.create("contextMenuItemTaggingDialog","TaggingDialog",a.MenuItemLocation.NoteListContextMenu)}))}})},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ContentScriptType=e.SettingItemType=e.ToolbarButtonLocation=e.isContextMenuItemLocation=e.MenuItemLocation=e.ImportModuleOutputFormat=e.FileSystemItem=void 0,function(t){t.File="file",t.Directory="directory"}(e.FileSystemItem||(e.FileSystemItem={})),function(t){t.Markdown="md",t.Html="html"}(e.ImportModuleOutputFormat||(e.ImportModuleOutputFormat={})),function(t){t.File="file",t.Edit="edit",t.View="view",t.Note="note",t.Tools="tools",t.Help="help",t.Context="context",t.NoteListContextMenu="noteListContextMenu",t.EditorContextMenu="editorContextMenu",t.FolderContextMenu="folderContextMenu",t.TagContextMenu="tagContextMenu"}(i=e.MenuItemLocation||(e.MenuItemLocation={})),e.isContextMenuItemLocation=function(t){return[i.Context,i.NoteListContextMenu,i.EditorContextMenu,i.FolderContextMenu,i.TagContextMenu].includes(t)},function(t){t.NoteToolbar="noteToolbar",t.EditorToolbar="editorToolbar"}(e.ToolbarButtonLocation||(e.ToolbarButtonLocation={})),function(t){t[t.Int=1]="Int",t[t.String=2]="String",t[t.Bool=3]="Bool",t[t.Array=4]="Array",t[t.Object=5]="Object",t[t.Button=6]="Button"}(e.SettingItemType||(e.SettingItemType={})),function(t){t.MarkdownItPlugin="markdownItPlugin",t.CodeMirrorPlugin="codeMirrorPlugin"}(e.ContentScriptType||(e.ContentScriptType={}))},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function r(t){try{u(i.next(t))}catch(t){a(t)}}function l(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,l)}u((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.tagging=e.tagDialog=void 0;const o=n(0),a=n(4),r=n(5);!function(t){function n(t,e){return i(this,void 0,void 0,(function*(){return yield o.default.data.get(["search"],{query:t,type:"tag",fields:"id,title",limit:e,sort:"title ASC"})}))}function l(t,e){return i(this,void 0,void 0,(function*(){let i=[];t=t.trim();let o=yield n(t,10+e.length);for(const t of o.items)if(-1===e.indexOf(t.id)&&i.push({id:t.id,title:t.title}),10==i.length)break;o=yield n(t+"*",10+e.length);for(const t of o.items)if(-1===i.map(t=>t.title).indexOf(t.title)&&-1===e.indexOf(t.id)&&i.push({id:t.id,title:t.title}),10==i.length)break;if(i.length<10){o=yield n("*"+t+"*",10+e.length);for(const t of o.items)if(-1===i.map(t=>t.title).indexOf(t.title)&&-1===e.indexOf(t.id)&&i.push({id:t.id,title:t.title}),i.length>=10)break}return i.sort((t,e)=>a(t.title,e.title,{caseInsensitive:!0})),i}))}t.showTaggingDialog=function(n){return i(this,void 0,void 0,(function*(){const a=[];for(const t in n)if(a.push(yield r.createTagHTML(t,n[t].status,n[t].title)),40==a.length)break;const l=document.createElement("div");l.setAttribute("id","copytags");const u=document.createElement("div");u.setAttribute("id","autocomplete"),u.setAttribute("class","autocomplete");const s=document.createElement("textarea");s.setAttribute("id","query-input"),s.setAttribute("rows","1"),s.setAttribute("name","addTag"),s.setAttribute("placeholder","Tag search"),u.appendChild(s);const d=document.createElement("form");d.setAttribute("name","tags");const c=document.createElement("div");if(c.setAttribute("id","assignedTags"),c.innerHTML=a.join("\n"),d.appendChild(c),l.appendChild(u),l.appendChild(d),40==a.length){const t=document.createElement("div");t.setAttribute("id","tagwarning"),t.innerHTML="Too many tags!",l.appendChild(t)}return yield o.default.views.dialogs.setHtml(e.tagDialog,l.outerHTML),o.default.views.panels.onMessage(e.tagDialog,e=>i(this,void 0,void 0,(function*(){return t.processDialogMsg(e)}))),yield o.default.views.dialogs.open(e.tagDialog)}))},t.getTaggingInfo=function(t){return i(this,void 0,void 0,(function*(){let e={};for(const a of t){var n=1;do{var i=yield o.default.data.get(["notes",a,"tags"],{fields:"id, title",limit:20,page:n++});for(const t of i.items)void 0===e[t.id]?(e[t.id]={},e[t.id].count=1,e[t.id].title=t.title):e[t.id].count++}while(i.has_more)}for(const n in e)e[n].count==t.length?e[n].status=1:e[n].status=2;return e}))},t.processTags=function(t,e,n){return i(this,void 0,void 0,(function*(){for(var i in e)if("new_"===i.substring(0,4)){if(1==e[i]){const e=i.substring(4),n=yield o.default.data.post(["tags"],null,{title:e});for(var a=0;a<t.length;a++)yield o.default.data.post(["tags",n.id,"notes"],null,{id:t[a]})}}else if(void 0===n[i]||e[i]!=n[i].status)if(0==e[i])for(a=0;a<t.length;a++)yield o.default.data.delete(["tags",i,"notes",t[a]]);else if(1==e[i])for(a=0;a<t.length;a++)yield o.default.data.post(["tags",i,"notes"],null,{id:t[a]})}))},t.processDialogMsg=function(t){return i(this,void 0,void 0,(function*(){let e=null;if("tagSearch"===t.type){e={type:"tagResult",result:yield l(t.query,t.exclude)}}return e}))},t.searchTag=n,t.getTags=l,t.copyAllTags=function(){return i(this,void 0,void 0,(function*(){var t=yield o.default.workspace.selectedNoteIds();if(t.length>1){const r=yield o.default.data.get(["notes",t[0]],{fields:["id","title"]});if(0==(yield o.default.views.dialogs.showMessageBox(`Copy all tags from ${r.title}?`))){var e=1;do{for(var n=yield o.default.data.get(["notes",t[0],"tags"],{fields:"id",limit:10,page:e++}),i=0;i<n.items.length;i++)for(var a=1;a<t.length;a++)yield o.default.data.post(["tags",n.items[i].id,"notes"],null,{id:t[a]})}while(n.has_more)}}}))},t.createDialog=function(){return i(this,void 0,void 0,(function*(){e.tagDialog=yield o.default.views.dialogs.create("TagDialog"),yield o.default.views.dialogs.addScript(e.tagDialog,"webview.js"),yield o.default.views.dialogs.addScript(e.tagDialog,"webview.css")}))}}(e.tagging||(e.tagging={}))},function(t,e,n){"use strict";const i=[];function o(t){return t>=48&&t<=57}const a={};t.exports=function(t,e,n){if("string"!=typeof t)throw new TypeError(`The first argument must be a string. Received type '${typeof t}'`);if("string"!=typeof e)throw new TypeError(`The second argument must be a string. Received type '${typeof e}'`);const r=t.length,l=e.length;let u=0,s=0,d=i,c=0;for(n&&(n.caseInsensitive&&(t=t.toLowerCase(),e=e.toLowerCase()),n.alphabet&&(d=function(t){const e=a[t];if(void 0!==e)return e;const n=[],i=t.split("").reduce((t,e)=>Math.max(t,e.charCodeAt(0)),0);for(let t=0;t<=i;t++)n.push(-1);for(let e=0;e<t.length;e++)n[t.charCodeAt(e)]=e;return a[t]=n,n}(n.alphabet)));u<r&&s<l;){let n=t.charCodeAt(u),i=e.charCodeAt(s);if(o(n)){if(!o(i))return n-i;let a=u,d=s;for(;48===n&&++a<r;)n=t.charCodeAt(a);for(;48===i&&++d<l;)i=e.charCodeAt(d);a!==d&&0===c&&(c=a-d);let g=a,f=d;for(;g<r&&o(t.charCodeAt(g));)++g;for(;f<l&&o(e.charCodeAt(f));)++f;let p=g-a-f+d;if(0!==p)return p;for(;a<g;)if(p=t.charCodeAt(a++)-e.charCodeAt(d++),0!==p)return p;u=g,s=f}else{if(n!==i)return n<d.length&&i<d.length&&-1!==d[n]&&-1!==d[i]?d[n]-d[i]:n-i;++u,++s}}return u<r?1:s<l?-1:c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createTagHTML=e.htmlToElem=void 0,e.htmlToElem=function(t){let e=document.createElement("template");return e.innerHTML=t,e.content.firstChild},e.createTagHTML=function(t,e,n){const i=document.createElement("div"),o=document.createElement("input"),a=document.createElement("span"),r=document.createElement("input"),l=document.createElement("label");return i.setAttribute("class","tag"),l.innerHTML=n,o.setAttribute("type","checkbox"),o.setAttribute("tagId",t),o.setAttribute("value",e.toString()),o.classList.add("tagcheckbox"),1==e?o.defaultChecked=!0:2==e&&o.classList.add("indeterminate"),a.setAttribute("class","checkmark"),r.setAttribute("type","hidden"),r.setAttribute("name",t),r.setAttribute("value",e.toString()),i.appendChild(o),i.appendChild(a),i.appendChild(l),i.appendChild(r),i.outerHTML}}]);